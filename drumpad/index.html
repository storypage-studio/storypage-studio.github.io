<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <title>ë“œëŸ¼ íŒ¨ë“œ</title>
    <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>ğŸ¥</text></svg>">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/tone/14.8.49/Tone.js"></script>
    <style>
        /* ê¸°ë³¸ ìŠ¤íƒ€ì¼ */
        html, body {
            height: 100%; margin: 0; padding: 0; font-family: 'Inter', sans-serif;
            background-color: #333; display: flex; justify-content: center;
            align-items: center; overflow: hidden; overscroll-behavior: none;
            touch-action: manipulation;
        }
        .drum-kit-container {
            display: flex; justify-content: center; align-items: center;
            width: 100%; height: 100%; position: relative;
        }
        #drum-kit {
            position: relative;
            /* ë‹¨ì¼ ë ˆì´ì•„ì›ƒ ì»¨í…Œì´ë„ˆ í¬ê¸° (vmin ê¸°ì¤€) */
            width: 105vmin;
            height: 70vmin;
            max-width: 100%; /* í™”ë©´ í¬ê¸° ì´ˆê³¼ ë°©ì§€ */
            max-height: 100%;
            margin-top: 10vmin;
        }

        .drum-pad {
            position: absolute; border-radius: 50%; cursor: pointer; user-select: none;
            display: flex; justify-content: center; align-items: center; font-weight: bold;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.3), inset 0 2px 4px rgba(255, 255, 255, 0.2);
            transition: transform 0.05s ease-out, box-shadow 0.05s ease-out;
            -webkit-tap-highlight-color: transparent;
            box-sizing: border-box;
            /* ë‹¨ì¼ ë ˆì´ì•„ì›ƒ í°íŠ¸ í¬ê¸° (vmin ê¸°ì¤€) */
            font-size: 2vmin;
        }
        .drum-pad.active {
            transform: scale(0.95);
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.5), inset 0 1px 2px rgba(0, 0, 0, 0.3);
        }
        .cymbal {
            background: radial-gradient(circle, #fde047, #eab308);
            /* ë‹¨ì¼ ë ˆì´ì•„ì›ƒ í…Œë‘ë¦¬ ë‘ê»˜ (vmin ê¸°ì¤€) */
            border: 0.8vmin solid #a16207;
            color: #713f12;
        }
        .drum-head {
            background: radial-gradient(circle, #f3f4f6, #d1d5db);
            /* ë‹¨ì¼ ë ˆì´ì•„ì›ƒ í…Œë‘ë¦¬ ë‘ê»˜ (vmin ê¸°ì¤€) */
            border: 1vmin solid #4b5563;
            color: #1f2937;
        }

        /* --- ë‹¨ì¼ ë ˆì´ì•„ì›ƒ ë“œëŸ¼ íŒ¨ë“œ ìœ„ì¹˜ (%) ë° í¬ê¸° (vmin ì‚¬ìš© -> ì›í˜• ë³´ì¥) --- */
        /* ìœ„ì¹˜ ê°’ (%) */
        #crash { top: 0; left: 5%; }
        #hi-hat { top: 35%; left: 0; }
        #ride { top: 0; right: 5%; }
        #snare { bottom: 28%; left: 18%; }
        #tom1 { top: 18%; left: 32%; }
        #tom2 { top: 18%; right: 32%; }
        #kick { bottom: 0; left: 50%; transform: translateX(-50%); }
        #floor-tom { bottom: 20%; right: 12%; }
        /* í¬ê¸° ê°’ (vmin) */
        #crash { width: 28vmin; height: 28vmin; }
        #hi-hat { width: 23vmin; height: 23vmin; }
        #ride { width: 33vmin; height: 33vmin; }
        #snare { width: 25vmin; height: 25vmin; }
        #tom1 { width: 20vmin; height: 20vmin; }
        #tom2 { width: 21vmin; height: 21vmin; }
        #kick { width: 30vmin; height: 30vmin; }
        #floor-tom { width: 27vmin; height: 27vmin; }
        /* ---------------------------------------------------------------------- */

        /* ë¯¸ë””ì–´ ì¿¼ë¦¬ ì œê±°ë¨ */

        /* --- ì „ì²´ í™”ë©´ ë²„íŠ¼ ìŠ¤íƒ€ì¼ ê°œì„  --- */
        #fullscreen-btn {
            position: absolute; top: 15px; right: 15px; width: 44px; height: 44px;
            background: radial-gradient(circle, #6b7280, #4b5563); border: 2px solid #374151;
            border-radius: 50%; cursor: pointer; z-index: 100;
            box-shadow: 0 3px 6px rgba(0, 0, 0, 0.4); display: flex;
            justify-content: center; align-items: center; padding: 0;
            transition: background 0.2s ease, transform 0.1s ease;
        }
        #fullscreen-btn:hover { background: radial-gradient(circle, #808892, #5c6672); }
        #fullscreen-btn:active { transform: scale(0.95); box-shadow: 0 1px 3px rgba(0, 0, 0, 0.3); }
        #fullscreen-btn svg { width: 20px; height: 20px; fill: #f3f4f6; }
        .exit-fullscreen-icon { display: none; }
        /* -------------------------- */

    </style>
</head>
<body>
<div class="drum-kit-container">
    <div id="drum-kit">
        <div id="crash" class="drum-pad cymbal" data-sound="crash">Crash</div>
        <div id="hi-hat" class="drum-pad cymbal" data-sound="hi-hat">Hi-Hat</div>
        <div id="ride" class="drum-pad cymbal" data-sound="ride">Ride</div>
        <div id="snare" class="drum-pad drum-head" data-sound="snare">Snare</div>
        <div id="tom1" class="drum-pad drum-head" data-sound="tom1">Tom 1</div>
        <div id="tom2" class="drum-pad drum-head" data-sound="tom2">Tom 2</div>
        <div id="kick" class="drum-pad drum-head" data-sound="kick">Kick</div>
        <div id="floor-tom" class="drum-pad drum-head" data-sound="floor-tom">Floor Tom</div>
    </div>
    <button id="fullscreen-btn" aria-label="ì „ì²´ í™”ë©´ í† ê¸€">
        <svg class="fullscreen-icon" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M7 14H5v5h5v-2H7v-3zm-2-4h2V7h3V5H5v5zm12 7h-3v2h5v-5h-2v3zM14 5v2h3v3h2V5h-5z"/></svg>
        <svg class="exit-fullscreen-icon" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M5 16h3v3h2v-5H5v2zm3-8H5v2h5V5H8v3zm6 11h2v-3h3v-2h-5v5zm2-11V5h-2v5h5V8h-3z"/></svg>
    </button>
</div>

<script>
    // Tone.js ì˜¤ë””ì˜¤ ì»¨í…ìŠ¤íŠ¸ ì‹œì‘
    let audioStarted = false;
    const startAudio = async () => {
        // Tone.js ì»¨í…ìŠ¤íŠ¸ ìƒíƒœ í™•ì¸ ë° ì‹œì‘
        if (Tone.context.state !== 'running') {
            await Tone.start();
            console.log('Audio context started');
        }
        audioStarted = true; // ì˜¤ë””ì˜¤ ì‹œì‘ë¨ í”Œë˜ê·¸ ì„¤ì •
        // ì˜¤ë””ì˜¤ ì‹œì‘ í›„ì—ëŠ” ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ì œê±° (í•œ ë²ˆë§Œ ì‹¤í–‰)
        ['click', 'touchstart'].forEach(evt =>
            document.body.removeEventListener(evt, startAudio)
        );
    };
    // í˜ì´ì§€ ë¡œë“œ í›„ ì²« í´ë¦­/í„°ì¹˜ ì‹œ ì˜¤ë””ì˜¤ ì»¨í…ìŠ¤íŠ¸ ì‹œì‘
    ['click', 'touchstart'].forEach(evt =>
        document.body.addEventListener(evt, startAudio)
    );


    // ì‚¬ìš´ë“œ ë°¸ëŸ°ìŠ¤ ì¡°ì •
    const mainVolume = new Tone.Volume(-4).toDestination();

    // ë“œëŸ¼ ì‚¬ìš´ë“œ ì •ì˜ (ì´ì „ê³¼ ë™ì¼)
    const sounds = {
        'kick': new Tone.MembraneSynth({ pitchDecay: 0.04, octaves: 7, oscillator: { type: 'sine' }, envelope: { attack: 0.001, decay: 0.5, sustain: 0.01, release: 1.4, attackCurve: 'exponential' } }).connect(mainVolume),
        'snare': new Tone.NoiseSynth({ noise: { type: 'white' }, envelope: { attack: 0.005, decay: 0.2, sustain: 0 } }).connect(mainVolume),
        'hi-hat': new Tone.MetalSynth({ frequency: 200, envelope: { attack: 0.001, decay: 0.1, release: 0.05 }, harmonicity: 5.1, modulationIndex: 32, resonance: 4000, octaves: 1.5 }).connect(mainVolume),
        'crash': new Tone.MetalSynth({ frequency: 300, envelope: { attack: 0.001, decay: 1.5, release: 1 }, harmonicity: 5.1, modulationIndex: 64, resonance: 3000, octaves: 1.5 }).connect(mainVolume),
        'ride': new Tone.MetalSynth({ frequency: 400, envelope: { attack: 0.001, decay: 1.0, release: 0.5 }, harmonicity: 4.1, modulationIndex: 40, resonance: 3500, octaves: 1.2 }).connect(mainVolume),
        'tom1': new Tone.Synth({ oscillator: { type: 'sine' }, envelope: { attack: 0.005, decay: 0.4, sustain: 0, release: 0.2 } }).connect(mainVolume),
        'tom2': new Tone.Synth({ oscillator: { type: 'sine' }, envelope: { attack: 0.005, decay: 0.45, sustain: 0, release: 0.25 } }).connect(mainVolume),
        'floor-tom': new Tone.Synth({ oscillator: { type: 'sine' }, envelope: { attack: 0.005, decay: 0.6, sustain: 0, release: 0.4 } }).connect(mainVolume),
    };

    // ê°œë³„ ì•…ê¸° ë³¼ë¥¨ ì¡°ì • (ì´ì „ê³¼ ë™ì¼)
    sounds['kick'].volume.value = 0;
    sounds['snare'].volume.value = +2;
    sounds['hi-hat'].volume.value = 0;
    sounds['crash'].volume.value = 0;
    sounds['ride'].volume.value = -2;
    sounds['tom1'].volume.value = -2;
    sounds['tom2'].volume.value = -2;
    sounds['floor-tom'].volume.value = 0;

    // ë“œëŸ¼ íŒ¨ë“œ ìš”ì†Œ ê°€ì ¸ì˜¤ê¸°
    const pads = document.querySelectorAll('.drum-pad');

    // ì‚¬ìš´ë“œ íŠ¸ë¦¬ê±° ë° ì‹œê° íš¨ê³¼ í•¨ìˆ˜ (ì´ì „ê³¼ ë™ì¼)
    const triggerSound = (soundId, element) => {
        const sound = sounds[soundId];
        if (sound) {
            const now = Tone.now();
            if (soundId === 'snare' || soundId === 'hi-hat' || soundId === 'crash' || soundId === 'ride') {
                sound.triggerAttackRelease("8n", now);
            } else {
                let pitch = "C1";
                if (soundId === 'tom1') pitch = "G3";
                else if (soundId === 'tom2') pitch = "D3";
                else if (soundId === 'floor-tom') pitch = "C3";
                sound.triggerAttackRelease(pitch, "8n", now);
            }
            element.classList.add('active');
            setTimeout(() => {
                element.classList.remove('active');
            }, 100);
        } else {
            console.warn(`Sound definition not found for ID: ${soundId}`);
        }
    };

    // ê° íŒ¨ë“œì— ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ì¶”ê°€ (ì´ì „ê³¼ ë™ì¼)
    pads.forEach(pad => {
        const soundId = pad.dataset.sound || pad.id;
        const playSoundHandler = (event) => {
            event.preventDefault();
            if (!audioStarted) {
                startAudio().then(() => {
                    triggerSound(soundId, pad);
                });
            } else {
                triggerSound(soundId, pad);
            }
        };
        pad.addEventListener('mousedown', playSoundHandler);
        pad.addEventListener('touchstart', playSoundHandler, { passive: false });
    });

    // --- ì „ì²´ í™”ë©´ ê¸°ëŠ¥ (ì•„ì´ì½˜ í† ê¸€ ì¶”ê°€) ---
    const fullscreenBtn = document.getElementById('fullscreen-btn');
    const docElement = document.documentElement;
    const fullscreenIcon = fullscreenBtn.querySelector('.fullscreen-icon');
    const exitFullscreenIcon = fullscreenBtn.querySelector('.exit-fullscreen-icon');

    function updateFullscreenIcons() {
        if (document.fullscreenElement || document.webkitFullscreenElement || document.mozFullScreenElement || document.msFullscreenElement) {
            fullscreenIcon.style.display = 'none';
            exitFullscreenIcon.style.display = 'inline-block';
        } else {
            fullscreenIcon.style.display = 'inline-block';
            exitFullscreenIcon.style.display = 'none';
        }
    }

    fullscreenBtn.addEventListener('click', () => {
        if (!document.fullscreenElement && !document.webkitFullscreenElement && !document.mozFullScreenElement && !document.msFullscreenElement) {
            if (docElement.requestFullscreen) docElement.requestFullscreen();
            else if (docElement.webkitRequestFullscreen) docElement.webkitRequestFullscreen();
            else if (docElement.mozRequestFullScreen) docElement.mozRequestFullScreen();
            else if (docElement.msRequestFullscreen) docElement.msRequestFullscreen();
        } else {
            if (document.exitFullscreen) document.exitFullscreen();
            else if (document.webkitExitFullscreen) document.webkitExitFullscreen();
            else if (document.mozCancelFullScreen) document.mozCancelFullScreen();
            else if (document.msExitFullscreen) document.msExitFullscreen();
        }
    });

    ['fullscreenchange', 'webkitfullscreenchange', 'mozfullscreenchange', 'MSFullscreenChange'].forEach( event =>
        document.addEventListener(event, updateFullscreenIcons, false)
    );
    // -----------------------

    // í˜ì´ì§€ ë¡œë“œ ì™„ë£Œ ì‹œ ë©”ì‹œì§€ ë° ì´ˆê¸° ì•„ì´ì½˜ ìƒíƒœ ì„¤ì •
    window.addEventListener('load', () => {
        console.log("Drum pad ready. Touch or click a pad to start playing.");
        updateFullscreenIcons(); // ì´ˆê¸° ì•„ì´ì½˜ ìƒíƒœ ì„¤ì •
    });

</script>
</body>
</html>
